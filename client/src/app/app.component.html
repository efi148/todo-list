<!-- Main Toolbar -->
<mat-toolbar color="accent" class="app-toolbar">
    <span>Todo App</span>
    <div class="toolbar-spacer"></div>
    <button mat-icon-button (click)="toggleTheme()"
            [attr.aria-label]="'Current theme: ' + themeService.themeMode()"
            matTooltip="Current theme: {{ themeService.themeMode() }}">
        <mat-icon> {{
                themeService.themeMode() === 'light' ? 'light_mode' :
                    themeService.themeMode() === 'dark' ? 'dark_mode' : 'brightness_medium'
            }}
        </mat-icon>
    </button>
</mat-toolbar>

<!-- Main Content -->
<div class="app-container">
    <!-- Todo List -->
    @if (todos.length > 0) {
        <div class="todo-list-container">
            @for (todo of todos; track todo) {
                <mat-card class="todo-card" appearance="outlined">
                    <mat-card-content class="todo-card-content">
                        <div class="todo-main">
                            <mat-checkbox
                                    [checked]="todo.checked"
                                    (change)="todo.checked = !todo.checked; toggleChecked(todo)"
                                    [attr.aria-label]="'Mark ' + todo.title + (todo.checked ? ' as incomplete' : ' as complete')">
                            </mat-checkbox>

                            <div class="todo-text" [class.completed]="todo.checked">
                                <h3 class="todo-title text-ellipsis">{{ todo.title }}
                                    @if (todo.description && todo.description.trim()) {
                                        |<span class="todo-description text-ellipsis"> {{ todo.description }}</span>
                                    }
                                </h3>

                            </div>
                        </div>

                        <div class="todo-actions">
                            <button mat-icon-button (click)="openTodoDialog('view',todo)" matTooltip="Expand"
                                    matTooltipPosition="above">
                                <mat-icon>arrow_outward</mat-icon>
                            </button>
                            <button mat-icon-button (click)="openTodoDialog('edit', todo)" matTooltip="Edit"
                                    matTooltipPosition="above">
                                <mat-icon>edit</mat-icon>
                            </button>
                            <button mat-icon-button (click)="deleteTodo(todo.id)" matTooltip="Delete"
                                    matTooltipPosition="above">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </div>
                    </mat-card-content>
                </mat-card>
            }
        </div>
    }

    <!-- Empty State -->
    @if (todos.length === 0) {
        <div class="empty-state">
            <mat-card class="empty-card">
                <mat-card-content class="empty-content">
                    <mat-icon class="empty-icon">task_alt</mat-icon>
                    <h2>There is nothing here...</h2>
                    <p>You can create a new task by clicking the + button</p>
                </mat-card-content>
            </mat-card>
        </div>
    }
</div>

<!-- Floating Action Button -->
<button mat-fab color="primary" class="fab" (click)="openTodoDialog('create')">
    <mat-icon>add</mat-icon>
</button>
